{"ast":null,"code":"import _objectSpread from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useCallback,useEffect,useState}from'react';import axios from'axios';import Modal from'react-modal';import PropertyPictures from'./propertyPictures.component';import OwnerAuctionInterface from'./ownerAuctionInterface.component';import BuyerAuctionInterface from'./buyerAuctionInterface.component';import{io}from'socket.io-client';import{timeConverter}from'./timerFunction';import{convertAmount}from'./convertAmount';import'./auctionPage.styles.css';var REACT_APP_SERVER_URL=process.env.REACT_APP_SERVER_URL;var AuctionPage=function AuctionPage(props){var _property$address,_property$address2,_property$address3;var id=props.match.params.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),property=_useState2[0],setProperty=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isOwner=_useState4[0],setIsOwner=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setIsOpen=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),timeRemaining=_useState8[0],setTimeRemaining=_useState8[1];var socketCallback=useCallback(function(payload){var auction=JSON.parse(payload);if(auction.propertyOnSale===id){setProperty(function(curState){console.log('CURSTATE: ',curState);return _objectSpread(_objectSpread({},curState),{},{auction:_objectSpread(_objectSpread({},curState.auction),{},{currentHighestBid:auction.currentHighestBid}),description:curState.description});});}console.log(payload);console.log('Socket connection established');});useEffect(function(){var socket=io(process.env.REACT_APP_SERVER_URL,{transports:['websocket']});socket.on('bid',socketCallback);//I don't need to import process.env above. React does it for me as long as I have it included in the .env file.\n//It's good to have the socket.io client function in useEffect callback because we need to make sure the compoent has loaded first because client relies on broswer.\naxios.get(\"\".concat(REACT_APP_SERVER_URL,\"/properties/\").concat(id),{headers:{Authorization:localStorage.getItem('accessToken')}}).then(function(res){setProperty(res.data);setIsOwner(localStorage.getItem('userId')===res.data.owner);console.log('DATA: ',res.data);var endDate=new Date(res.data.auction.auctionEndTime).getTime();console.log('ENDDATE: ',endDate);var now=new Date().getTime();console.log('NOW: ',now);var timeTillEnd=timeConverter(endDate-now);setTimeRemaining(timeTillEnd);}).catch(function(err){return console.log(err);});return function(){return socket.disconnect();};},[]);//If I use some variable from outer scope(like 'id' here) in useEffect, that varialbe needs to go inside the array after the useEffect, because it's a presumption of React that I might have have forgottent it. It's because my state can be dependent on the value of that variable. This callback in useEffect will run everytime and only when the id changes.\nvar openModal=function openModal(){setIsOpen(true);};return/*#__PURE__*/_jsx(\"div\",{className:\"auction-page\",children:property&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\".concat((_property$address=property.address)===null||_property$address===void 0?void 0:_property$address.street,\", \").concat((_property$address2=property.address)===null||_property$address2===void 0?void 0:_property$address2.city,\", \").concat((_property$address3=property.address)===null||_property$address3===void 0?void 0:_property$address3.state)}),/*#__PURE__*/_jsx(\"div\",{className:\"description\",children:\"\\\"\".concat(property.description,\"\\\"\")})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"picture-and-auction-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"one-picture\",onClick:openModal,children:/*#__PURE__*/_jsx(\"img\",{src:property.images[0]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"auction-info\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Current Highest Bid:\",' ',convertAmount(property.auction.currentHighestBid)]}),\"Auction Ends in \",timeRemaining]}),/*#__PURE__*/_jsx(\"div\",{className:\"by-user-type-interface\",children:isOwner?/*#__PURE__*/_jsx(OwnerAuctionInterface// id={property.auction.propertyOnSale}\n// bids={property.auction.bids}\n,{property:property}):/*#__PURE__*/_jsx(BuyerAuctionInterface,{address:property.address,bids:property.auction.bids})})]})]}),/*#__PURE__*/_jsxs(Modal,{style:{overlay:{position:'fixed',height:'660px',width:'680px',top:80,left:80,right:0,bottom:0,backgroundColor:'rgba(255, 255, 255, 0.75)'},content:{position:'absolute',top:'40px',left:'40px',right:'40px',bottom:'40px',border:'1px solid #ccc',background:'#fff',overflow:'auto',WebkitOverflowScrolling:'touch',borderRadius:'4px',outline:'none',padding:'20px'}},isOpen:isOpen,contentLabel:\"Example Modal\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setIsOpen(false);},children:\"Close Modal\"}),/*#__PURE__*/_jsx(PropertyPictures,{pics:property.images})]})]})});};export default AuctionPage;","map":{"version":3,"sources":["/Users/joohoonkim/Documents/CW/auxion/client/src/components/auctionPage.component.jsx"],"names":["React","useCallback","useEffect","useState","axios","Modal","PropertyPictures","OwnerAuctionInterface","BuyerAuctionInterface","io","timeConverter","convertAmount","REACT_APP_SERVER_URL","process","env","AuctionPage","props","id","match","params","property","setProperty","isOwner","setIsOwner","isOpen","setIsOpen","timeRemaining","setTimeRemaining","socketCallback","payload","auction","JSON","parse","propertyOnSale","curState","console","log","currentHighestBid","description","socket","transports","on","get","headers","Authorization","localStorage","getItem","then","res","data","owner","endDate","Date","auctionEndTime","getTime","now","timeTillEnd","catch","err","disconnect","openModal","address","street","city","state","images","bids","overlay","position","height","width","top","left","right","bottom","backgroundColor","content","border","background","overflow","WebkitOverflowScrolling","borderRadius","outline","padding"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Modal from 'react-modal';\nimport PropertyPictures from './propertyPictures.component';\nimport OwnerAuctionInterface from './ownerAuctionInterface.component';\nimport BuyerAuctionInterface from './buyerAuctionInterface.component';\nimport { io } from 'socket.io-client';\nimport { timeConverter } from './timerFunction';\nimport { convertAmount } from './convertAmount';\n\nimport './auctionPage.styles.css';\nconst { REACT_APP_SERVER_URL } = process.env;\n\nconst AuctionPage = (props) => {\n  const { id } = props.match.params;\n  const [property, setProperty] = useState(null);\n  const [isOwner, setIsOwner] = useState(false);\n  const [isOpen, setIsOpen] = useState(false);\n  const [timeRemaining, setTimeRemaining] = useState(0);\n\n  const socketCallback = useCallback((payload) => {\n    const auction = JSON.parse(payload);\n    if (auction.propertyOnSale === id) {\n      setProperty((curState) => {\n        console.log('CURSTATE: ', curState);\n        return {\n          ...curState,\n          auction: {\n            ...curState.auction,\n            currentHighestBid: auction.currentHighestBid,\n          },\n          description: curState.description,\n        };\n      });\n    }\n    console.log(payload);\n    console.log('Socket connection established');\n  });\n  useEffect(() => {\n    const socket = io(process.env.REACT_APP_SERVER_URL, {\n      transports: ['websocket'],\n    });\n    socket.on('bid', socketCallback);\n    //I don't need to import process.env above. React does it for me as long as I have it included in the .env file.\n\n    //It's good to have the socket.io client function in useEffect callback because we need to make sure the compoent has loaded first because client relies on broswer.\n\n    axios\n      .get(`${REACT_APP_SERVER_URL}/properties/${id}`, {\n        headers: {\n          Authorization: localStorage.getItem('accessToken'),\n        },\n      })\n      .then((res) => {\n        setProperty(res.data);\n        setIsOwner(localStorage.getItem('userId') === res.data.owner);\n        console.log('DATA: ', res.data);\n        let endDate = new Date(res.data.auction.auctionEndTime).getTime();\n        console.log('ENDDATE: ', endDate);\n        let now = new Date().getTime();\n        console.log('NOW: ', now);\n\n        let timeTillEnd = timeConverter(endDate - now);\n        setTimeRemaining(timeTillEnd);\n      })\n      .catch((err) => console.log(err));\n    return () => socket.disconnect();\n  }, []);\n  //If I use some variable from outer scope(like 'id' here) in useEffect, that varialbe needs to go inside the array after the useEffect, because it's a presumption of React that I might have have forgottent it. It's because my state can be dependent on the value of that variable. This callback in useEffect will run everytime and only when the id changes.\n\n  const openModal = () => {\n    setIsOpen(true);\n  };\n\n  return (\n    <div className=\"auction-page\">\n      {property && (\n        <>\n          <div>\n            <h1>{`${property.address?.street}, ${property.address?.city}, ${property.address?.state}`}</h1>\n            <div className=\"description\">{`\"${property.description}\"`}</div>\n          </div>\n          <section className=\"picture-and-auction-info\">\n            <div className=\"one-picture\" onClick={openModal}>\n              <img src={property.images[0]} />\n            </div>\n            <div className=\"auction-info\">\n              <div>\n                <h2>\n                  Current Highest Bid:{' '}\n                  {convertAmount(property.auction.currentHighestBid)}\n                </h2>\n                Auction Ends in {timeRemaining}\n              </div>\n\n              <div className=\"by-user-type-interface\">\n                {isOwner ? (\n                  <OwnerAuctionInterface\n                    // id={property.auction.propertyOnSale}\n                    // bids={property.auction.bids}\n                    property={property}\n                  />\n                ) : (\n                  <BuyerAuctionInterface\n                    address={property.address}\n                    bids={property.auction.bids}\n                  />\n                )}\n              </div>\n            </div>\n          </section>\n\n          <Modal\n            style={{\n              overlay: {\n                position: 'fixed',\n                height: '660px',\n                width: '680px',\n                top: 80,\n                left: 80,\n                right: 0,\n                bottom: 0,\n                backgroundColor: 'rgba(255, 255, 255, 0.75)',\n              },\n              content: {\n                position: 'absolute',\n                top: '40px',\n                left: '40px',\n                right: '40px',\n                bottom: '40px',\n                border: '1px solid #ccc',\n                background: '#fff',\n                overflow: 'auto',\n                WebkitOverflowScrolling: 'touch',\n                borderRadius: '4px',\n                outline: 'none',\n                padding: '20px',\n              },\n            }}\n            isOpen={isOpen}\n            contentLabel=\"Example Modal\"\n          >\n            <button onClick={() => setIsOpen(false)}>Close Modal</button>\n            <PropertyPictures pics={property.images} />\n          </Modal>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default AuctionPage;\n"]},"metadata":{},"sourceType":"module"}