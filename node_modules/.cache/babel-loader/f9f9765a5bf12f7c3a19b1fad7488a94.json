{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/joohoonkim/Documents/CW/auxion/client/src/components/profile.component.jsx\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport PropertyCard from './propertyCard.component';\nimport BidCard from './bidCard.component';\nimport { io } from 'socket.io-client';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport './profile.styles.css';\nconst {\n  REACT_APP_SERVER_URL\n} = process.env;\nconst initialState = null;\n\nconst Profile = props => {\n  _s();\n\n  var _user$properties, _user$auctions;\n\n  const [user, setUser] = useState(initialState);\n  const name = user && user.name || 'Name missing..';\n  useEffect(() => {\n    const socket = io(process.env.REACT_APP_SERVER_URL, {\n      transports: ['websocket']\n    });\n    socket.on('bid', payload => {\n      const auction = JSON.parse(payload);\n      console.log('USER: ', user); //I need to use callback pattern of updating the state whenver I use a some kind of setstate function inside of another asynchronous function. Sockeit.io functions are asynchronous and react updates state in batches(asynchronous). If user is null, use callback pattern replacing it with a callback using curState => .. syntax.\n\n      setUser(curState => ({ ...curState,\n        auctions: curState.auctions.map(actn => actn._id === auction._id ? { ...actn,\n          currentHighestBid: auction.currentHighestBid\n        } : actn)\n      })); //I am mapping through all the auctions in the state looking for the auction that has the same id with the one that I have received through the websocket, and update the value with the one for the newly received auction. Used 'actn' instead of 'auction' to prevent the latter from shadowing original auction in the state\n\n      console.log('AUCTION: ', auction);\n      console.log('Socket connection established');\n    });\n    const accessToken = localStorage.getItem('accessToken');\n    console.log('ACCESS TKN', accessToken);\n\n    const getProfile = async accessToken => {\n      const userInfo = await fetch(`${REACT_APP_SERVER_URL}/me`, {\n        method: 'GET',\n        // credentials: 'include',\n        mode: 'cors',\n        headers: {\n          // 'Content-Type': 'application/json',\n          Authorization: `Bearer ${accessToken}`\n        }\n      }).then(res => res.json()).catch(err => console.log(err));\n      console.log('USERINFO at Proifle Component after making get request call:', userInfo);\n\n      if (userInfo) {\n        setUser(userInfo); // const { name } = userInfo;\n        // setState((curState) => ({ ...curState, name }));\n      } else {\n        console.log('No user info found');\n      }\n    };\n\n    getProfile(accessToken);\n    console.log('inside of UseEffect: ');\n    return () => socket.disconnect();\n  }, []);\n  console.log('outside of UseEffect: '); //Need to display my property and auction status information below.\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Good day, \", name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"My Properties \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"my-properties\",\n      children: user && ((_user$properties = user.properties) === null || _user$properties === void 0 ? void 0 : _user$properties.map(({\n        _id,\n        ...otherProps\n      }) => /*#__PURE__*/_jsxDEV(PropertyCard, { ...otherProps,\n        id: _id\n      }, _id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }, this)))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 20\n      },\n      children: \"My Bids \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: [' ', /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: 'green'\n        },\n        children: \"Green\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), \" if your bid price is the highest bid at the moment.\", /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: 'red'\n        },\n        children: \" Red\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), \" if there is a higher bid price from another buyer\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: [\"Click on the card to adjust your bid terms\", /*#__PURE__*/_jsxDEV(ArrowDownwardIcon, {\n        className: \"arrow-downward\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), user && ((_user$auctions = user.auctions) === null || _user$auctions === void 0 ? void 0 : _user$auctions.map(auction => /*#__PURE__*/_jsxDEV(BidCard, {\n      auction: auction\n    }, auction._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }, this)))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this) //Guard user and also guard auctions as well just like properties? above\n  //Why do I need to guard it? What's happening is whenever React tries to update component(remounts parts of component necessary), it might not have the latest version of user in its state.\n  //\n  ;\n};\n\n_s(Profile, \"a7tWCTRu5UscEqGtKFKkzOJrmhA=\");\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["/Users/joohoonkim/Documents/CW/auxion/client/src/components/profile.component.jsx"],"names":["axios","React","useState","useEffect","Link","PropertyCard","BidCard","io","ArrowDownwardIcon","REACT_APP_SERVER_URL","process","env","initialState","Profile","props","user","setUser","name","socket","transports","on","payload","auction","JSON","parse","console","log","curState","auctions","map","actn","_id","currentHighestBid","accessToken","localStorage","getItem","getProfile","userInfo","fetch","method","mode","headers","Authorization","then","res","json","catch","err","disconnect","properties","otherProps","marginTop","color"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport PropertyCard from './propertyCard.component';\nimport BidCard from './bidCard.component';\nimport { io } from 'socket.io-client';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport './profile.styles.css';\n\nconst { REACT_APP_SERVER_URL } = process.env;\n\nconst initialState = null;\n\nconst Profile = (props) => {\n  const [user, setUser] = useState(initialState);\n\n  const name = (user && user.name) || 'Name missing..';\n\n  useEffect(() => {\n    const socket = io(process.env.REACT_APP_SERVER_URL, {\n      transports: ['websocket'],\n    });\n    socket.on('bid', (payload) => {\n      const auction = JSON.parse(payload);\n      console.log('USER: ', user);\n\n      //I need to use callback pattern of updating the state whenver I use a some kind of setstate function inside of another asynchronous function. Sockeit.io functions are asynchronous and react updates state in batches(asynchronous). If user is null, use callback pattern replacing it with a callback using curState => .. syntax.\n      setUser((curState) => ({\n        ...curState,\n        auctions: curState.auctions.map((actn) =>\n          actn._id === auction._id\n            ? { ...actn, currentHighestBid: auction.currentHighestBid }\n            : actn\n        ),\n      }));\n      //I am mapping through all the auctions in the state looking for the auction that has the same id with the one that I have received through the websocket, and update the value with the one for the newly received auction. Used 'actn' instead of 'auction' to prevent the latter from shadowing original auction in the state\n      console.log('AUCTION: ', auction);\n      console.log('Socket connection established');\n    });\n\n    const accessToken = localStorage.getItem('accessToken');\n    console.log('ACCESS TKN', accessToken);\n    const getProfile = async (accessToken) => {\n      const userInfo = await fetch(`${REACT_APP_SERVER_URL}/me`, {\n        method: 'GET',\n        // credentials: 'include',\n        mode: 'cors',\n        headers: {\n          // 'Content-Type': 'application/json',\n          Authorization: `Bearer ${accessToken}`,\n        },\n      })\n        .then((res) => res.json())\n        .catch((err) => console.log(err));\n\n      console.log(\n        'USERINFO at Proifle Component after making get request call:',\n        userInfo\n      );\n\n      if (userInfo) {\n        setUser(userInfo);\n        // const { name } = userInfo;\n        // setState((curState) => ({ ...curState, name }));\n      } else {\n        console.log('No user info found');\n      }\n    };\n    getProfile(accessToken);\n    console.log('inside of UseEffect: ');\n    return () => socket.disconnect();\n  }, []);\n  console.log('outside of UseEffect: ');\n  //Need to display my property and auction status information below.\n  return (\n    <div>\n      <h2>Good day, {name}</h2>\n      <h2>My Properties </h2>\n      <div className=\"my-properties\">\n        {user &&\n          user.properties?.map(({ _id, ...otherProps }) => (\n            <PropertyCard key={_id} {...otherProps} id={_id} />\n          ))}\n      </div>\n      <h2 style={{ marginTop: 20 }}>My Bids </h2>\n\n      <h4>\n        {' '}\n        <span style={{ color: 'green' }}>Green</span> if your bid price is the\n        highest bid at the moment.\n        <span style={{ color: 'red' }}> Red</span> if there is a higher bid\n        price from another buyer\n      </h4>\n\n      <h4>\n        Click on the card to adjust your bid terms\n        <ArrowDownwardIcon className=\"arrow-downward\" />\n      </h4>\n      {user &&\n        user.auctions?.map((auction) => (\n          <BidCard key={auction._id} auction={auction} />\n        ))}\n    </div>\n    //Guard user and also guard auctions as well just like properties? above\n    //Why do I need to guard it? What's happening is whenever React tries to update component(remounts parts of component necessary), it might not have the latest version of user in its state.\n    //\n  );\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}