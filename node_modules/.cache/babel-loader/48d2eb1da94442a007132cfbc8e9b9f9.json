{"ast":null,"code":"import _regeneratorRuntime from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{useEffect,useState}from'react';import axios from'axios';import'./editListingTerms.styles.css';var REACT_APP_SERVER_URL=process.env.REACT_APP_SERVER_URL;//TODO: This component written based on assumption of whole property as a prop.\n//Make another fetch to backend and use database as the signle source of truth in an edit component. Receiving state as props from parent is not reliable.\nvar EditListingTerms=function EditListingTerms(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),property=_useState2[0],setProperty=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),available=_useState6[0],setAvailable=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),files=_useState8[0],setFiles=_useState8[1];var _useState9=useState(new Date().toJSON().slice(0,10)),_useState10=_slicedToArray(_useState9,2),auctionEndTime=_useState10[0],setAuctionEndTime=_useState10[1];var id=props.match.params.id;var history=props.history;console.log('HISTORY AT EDIT: ',history);useEffect(function(){axios.get(\"\".concat(REACT_APP_SERVER_URL,\"/properties/\").concat(id),{headers:{Authorization:localStorage.getItem('accessToken')}}).then(function(res){prePopulateForm(res.data);console.log('DATA FROM EDIT COMP: ',res.data);}).catch(function(err){return console.log(err);});},[]);var handleDescriptionChange=function handleDescriptionChange(evt){setDescription(evt.target.value);};var handleAvailableChange=function handleAvailableChange(evt){console.log('VALUE :',evt.target.value);setAvailable(JSON.parse(evt.target.value));};var handleAuctionEndTimeChange=function handleAuctionEndTimeChange(evt){setAuctionEndTime(evt.target.value);};var handlePhotoSelect=function handlePhotoSelect(evt){setFiles(Array.from(evt.target.files));// console.log('EVT.TGT.FILES: ', evt.target.files);\n// setFilename(evt.target.files[0].name);\n};var prePopulateForm=function prePopulateForm(property){setProperty(property);setDescription(property.description);setAvailable(property.available);setAuctionEndTime(property.auction.auctionEndTime.slice(0,10));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(evt){var formData,response,_id;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();formData=new FormData();formData.append('description',JSON.stringify(description));formData.append('available',JSON.stringify(available));formData.append('auctionEndTime',JSON.stringify(auctionEndTime));files.forEach(function(file){return formData.append('file[]',file,file.name);});//https://developer.mozilla.org/en-US/docs/Web/API/FormData/append\n//sticking '[]' at the end for the browser to understand that it is an array (look at the examples part for the above doc. PHP convention but formData standard comes from PHP anyways. It's just like JSON is a convention of JS but used by other languages. Same thing)\nconsole.log(_toConsumableArray(formData.entries()));_context.prev=7;_context.next=10;return axios.patch(\"\".concat(REACT_APP_SERVER_URL,\"/properties/\").concat(props.match.params.id,\"/edit\"),formData,{headers:{'Content-Type':'multipart/form-data',Authorization:localStorage.getItem('accessToken')}});case 10:response=_context.sent;console.log('RESPONSE FOR EDITPROPERTY: ',response);_id=response.data._id;console.log('_ID HERE: ',_id);// console.log('HISTORY HERE: ', history);\nhistory.push(\"/properties/\".concat(_id));//Don't forget '/' before url //Q: Why does this run twice? Look at url address on broswer. A: It's not that it's running twice. If I forget '/' before the pathname, it apends the url to whatever was there before, which makes it look like it's run twice.\n_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](7);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[7,17]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();console.log('AVAIL',available);return/*#__PURE__*/ (// <div>\n//   <h2>Property Listing Form</h2>\n//   <span>Provide property address and Photo</span>\n_jsx(_Fragment,{children:property&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"available\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"available-radio\",children:\"Available\"}),/*#__PURE__*/_jsx(\"input\",{id:\"available-radio\",value:true,checked:available,onChange:handleAvailableChange,type:\"radio\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"unavailable-radio\",children:\"Unavailable\"}),/*#__PURE__*/_jsx(\"input\",{id:\"available-radio\",value:false,checked:!available,onChange:handleAvailableChange,type:\"radio\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"description\",children:\"Description \"}),/*#__PURE__*/_jsx(\"textarea\",{value:description,onChange:handleDescriptionChange,name:\"description\",id:\"description\",placeholder:\"Enter description\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"auctionEndTime\",children:\"Auction End Time\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:auctionEndTime,onChange:handleAuctionEndTimeChange,name:\"auctionEndTime\",id:\"auctionEndTime\",min:new Date().toJSON().slice(0,10),required:true})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,onChange:handlePhotoSelect,accept:\"image/*\"})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{children:\"Submit my edits\"})]})}));};export default EditListingTerms;","map":{"version":3,"sources":["/Users/joohoonkim/Documents/CW/auxion/client/src/components/editListingTerms.component.jsx"],"names":["React","useEffect","useState","axios","REACT_APP_SERVER_URL","process","env","EditListingTerms","props","property","setProperty","description","setDescription","available","setAvailable","files","setFiles","Date","toJSON","slice","auctionEndTime","setAuctionEndTime","id","match","params","history","console","log","get","headers","Authorization","localStorage","getItem","then","res","prePopulateForm","data","catch","err","handleDescriptionChange","evt","target","value","handleAvailableChange","JSON","parse","handleAuctionEndTimeChange","handlePhotoSelect","Array","from","auction","handleSubmit","preventDefault","formData","FormData","append","stringify","forEach","file","name","entries","patch","response","_id","push"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport './editListingTerms.styles.css';\n\nconst { REACT_APP_SERVER_URL } = process.env;\n\n//TODO: This component written based on assumption of whole property as a prop.\n//Make another fetch to backend and use database as the signle source of truth in an edit component. Receiving state as props from parent is not reliable.\nconst EditListingTerms = (props) => {\n  const [property, setProperty] = useState(null);\n  const [description, setDescription] = useState('');\n  const [available, setAvailable] = useState(true);\n  const [files, setFiles] = useState([]);\n  const [auctionEndTime, setAuctionEndTime] = useState(\n    new Date().toJSON().slice(0, 10)\n  );\n\n  const { id } = props.match.params;\n  const { history } = props;\n  console.log('HISTORY AT EDIT: ', history);\n\n  useEffect(() => {\n    axios\n      .get(`${REACT_APP_SERVER_URL}/properties/${id}`, {\n        headers: {\n          Authorization: localStorage.getItem('accessToken'),\n        },\n      })\n      .then((res) => {\n        prePopulateForm(res.data);\n        console.log('DATA FROM EDIT COMP: ', res.data);\n      })\n      .catch((err) => console.log(err));\n  }, []);\n\n  const handleDescriptionChange = (evt) => {\n    setDescription(evt.target.value);\n  };\n\n  const handleAvailableChange = (evt) => {\n    console.log('VALUE :', evt.target.value);\n    setAvailable(JSON.parse(evt.target.value));\n  };\n\n  const handleAuctionEndTimeChange = (evt) => {\n    setAuctionEndTime(evt.target.value);\n  };\n\n  const handlePhotoSelect = (evt) => {\n    setFiles(Array.from(evt.target.files));\n    // console.log('EVT.TGT.FILES: ', evt.target.files);\n    // setFilename(evt.target.files[0].name);\n  };\n\n  const prePopulateForm = (property) => {\n    setProperty(property);\n\n    setDescription(property.description);\n\n    setAvailable(property.available);\n    setAuctionEndTime(property.auction.auctionEndTime.slice(0, 10));\n  };\n\n  const handleSubmit = async (evt) => {\n    evt.preventDefault();\n    const formData = new FormData();\n    formData.append('description', JSON.stringify(description));\n    formData.append('available', JSON.stringify(available));\n    formData.append('auctionEndTime', JSON.stringify(auctionEndTime));\n\n    files.forEach((file) => formData.append('file[]', file, file.name));\n    //https://developer.mozilla.org/en-US/docs/Web/API/FormData/append\n    //sticking '[]' at the end for the browser to understand that it is an array (look at the examples part for the above doc. PHP convention but formData standard comes from PHP anyways. It's just like JSON is a convention of JS but used by other languages. Same thing)\n    console.log([...formData.entries()]);\n    try {\n      const response = await axios.patch(\n        `${REACT_APP_SERVER_URL}/properties/${props.match.params.id}/edit`,\n        formData,\n        {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            Authorization: localStorage.getItem('accessToken'),\n          },\n        }\n      );\n      console.log('RESPONSE FOR EDITPROPERTY: ', response);\n      const { _id } = response.data;\n\n      console.log('_ID HERE: ', _id);\n      // console.log('HISTORY HERE: ', history);\n      history.push(`/properties/${_id}`); //Don't forget '/' before url //Q: Why does this run twice? Look at url address on broswer. A: It's not that it's running twice. If I forget '/' before the pathname, it apends the url to whatever was there before, which makes it look like it's run twice.\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  console.log('AVAIL', available);\n\n  return (\n    // <div>\n    //   <h2>Property Listing Form</h2>\n    //   <span>Provide property address and Photo</span>\n\n    <>\n      {property && (\n        <form onSubmit={handleSubmit}>\n          <div className=\"available\">\n            <div>\n              <label htmlFor=\"available-radio\">Available</label>\n              <input\n                id=\"available-radio\"\n                value={true}\n                checked={available}\n                onChange={handleAvailableChange}\n                type=\"radio\"\n              />\n            </div>\n            <div>\n              <label htmlFor=\"unavailable-radio\">Unavailable</label>\n              <input\n                id=\"available-radio\"\n                value={false}\n                checked={!available}\n                onChange={handleAvailableChange}\n                type=\"radio\"\n              />\n            </div>\n          </div>\n          <div>\n            <label htmlFor=\"description\">Description </label>\n            <textarea\n              value={description}\n              onChange={handleDescriptionChange}\n              name=\"description\"\n              id=\"description\"\n              placeholder=\"Enter description\"\n              required\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"auctionEndTime\">Auction End Time</label>\n            <input\n              type=\"date\"\n              value={auctionEndTime}\n              onChange={handleAuctionEndTimeChange}\n              name=\"auctionEndTime\"\n              id=\"auctionEndTime\"\n              min={new Date().toJSON().slice(0, 10)}\n              required\n            />\n          </div>\n\n          <br />\n          <div>\n            <input\n              type=\"file\"\n              multiple={true}\n              onChange={handlePhotoSelect}\n              accept=\"image/*\"\n            />\n          </div>\n          {/*To enable multiple file uplaod, set multiple attribute to true(Don't do quotes. Wrap true in curly braces) */}\n          {/* <input type=\"submit\" value=\"click\"></input> */}\n          <br />\n          <button>Submit my edits</button>\n        </form>\n      )}\n    </>\n  );\n};\n\nexport default EditListingTerms;\n"]},"metadata":{},"sourceType":"module"}