{"ast":null,"code":"import _regeneratorRuntime from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/joohoonkim/Documents/CW/auxion/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import{withRouter,useParams}from'react-router-dom';var REACT_APP_SERVER_URL=process.env.REACT_APP_SERVER_URL;var initialState={email:'',password:''};var Login=function Login(props){var _useState=useState(initialState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),buttonEnabled=_useState4[0],setButtonEnabled=_useState4[1];// const router = useRouter();\n// const { from } = useParams();\nvar history=props.history;// console.log('FROMMMM ', from);\nvar id=new URLSearchParams(history.location.search).get('from');var email=state.email,password=state.password;var handleChange=function handleChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},name,value));});// console.log(email);\nsetButtonEnabled(email&&password&&Boolean(value));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(evt){var res,user,token,_id;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();setButtonEnabled(false);console.log(state);_context.next=5;return fetch(\"\".concat(REACT_APP_SERVER_URL,\"/login\"),{method:'POST',// credentials: 'include',\nmode:'cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(state)});case 5:res=_context.sent;console.log('RESPONSE ***** ',res);if(!res.ok){_context.next=20;break;}_context.next=10;return res.json();case 10:user=_context.sent;console.log('USER >>>>>',user);token=user.token,_id=user._id;localStorage.setItem('accessToken',token);localStorage.setItem('userId',_id);//push the whole user into localStorage\nprops.handleAuth(true);//set isAuthenticated to true using handleAuth function passed down from App component\nsetState({email:'',password:''});//clean out the fields\nhistory&&history.push(id?\"properties/\".concat(id):'/profile');//TODO: if it did NOT come from an unauthenticated user clicking on a property detail button from landing page, but rather\n//it came from the navbar login, then we should send the user to profile page first\n_context.next=21;break;case 20:alert('Login failed');// throw new Error();\ncase 21:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{className:\"sign-in\",onSubmit:handleSubmit// style={{\n//   display: 'flex',\n//   flexDirection: 'column',\n//   width: '30vw',\n//   margin: '0 auto',\n//   marginTop: '8vw',\n//   justifyContent: 'space-around',\n//   height: '35vw',\n//   border: '1px solid grey',\n//   borderRadius: '1rem',\n//   padding: '3rem',\n// }}\n,children:[/*#__PURE__*/_jsx(\"div\",{className:\"field\",style:{width:'100%'},children:/*#__PURE__*/_jsxs(\"label\",{children:[\"email\",/*#__PURE__*/_jsx(\"input\",{name:\"email\",type:\"email\",value:state.email,onChange:handleChange,required:true,style:{width:'100%',letterSpacing:'.2rem',height:'2rem',border:'none',borderBottom:'1px solid grey'}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"password\"}),/*#__PURE__*/_jsx(\"input\",{name:\"password\",type:\"password\",value:state.password,onChange:handleChange,required:true,style:{width:'100%',letterSpacing:'.3rem',height:'2rem',border:'none',borderBottom:'1px solid grey'}})]}),/*#__PURE__*/_jsx(\"button\",{children:\"Log in\"})]});};export default withRouter(Login);","map":{"version":3,"sources":["/Users/joohoonkim/Documents/CW/auxion/client/src/components/login.component.jsx"],"names":["React","useState","withRouter","useParams","REACT_APP_SERVER_URL","process","env","initialState","email","password","Login","props","state","setState","buttonEnabled","setButtonEnabled","history","id","URLSearchParams","location","search","get","handleChange","evt","target","name","value","prevState","Boolean","handleSubmit","preventDefault","console","log","fetch","method","mode","headers","body","JSON","stringify","res","ok","json","user","token","_id","localStorage","setItem","handleAuth","push","alert","width","letterSpacing","height","border","borderBottom"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { withRouter, useParams } from 'react-router-dom';\n\nconst REACT_APP_SERVER_URL = process.env.REACT_APP_SERVER_URL;\n\nconst initialState = {\n  email: '',\n  password: '',\n};\n\nconst Login = (props) => {\n  const [state, setState] = useState(initialState);\n  const [buttonEnabled, setButtonEnabled] = useState(false);\n  // const router = useRouter();\n  // const { from } = useParams();\n  const { history } = props;\n  // console.log('FROMMMM ', from);\n\n  const id = new URLSearchParams(history.location.search).get('from');\n\n  const { email, password } = state;\n\n  const handleChange = (evt) => {\n    const { name, value } = evt.target;\n    setState((prevState) => ({\n      ...prevState,\n      [name]: value,\n    }));\n    // console.log(email);\n\n    setButtonEnabled(email && password && Boolean(value));\n  };\n\n  const handleSubmit = async (evt) => {\n    evt.preventDefault();\n    setButtonEnabled(false);\n\n    console.log(state);\n    const res = await fetch(`${REACT_APP_SERVER_URL}/login`, {\n      method: 'POST',\n      // credentials: 'include',\n      mode: 'cors',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(state),\n    });\n    console.log('RESPONSE ***** ', res);\n    if (res.ok) {\n      const user = await res.json();\n      console.log('USER >>>>>', user);\n      const { token, _id } = user;\n      localStorage.setItem('accessToken', token);\n      localStorage.setItem('userId', _id);\n      //push the whole user into localStorage\n      props.handleAuth(true); //set isAuthenticated to true using handleAuth function passed down from App component\n      setState({ email: '', password: '' }); //clean out the fields\n      history && history.push(id ? `properties/${id}` : '/profile');\n      //TODO: if it did NOT come from an unauthenticated user clicking on a property detail button from landing page, but rather\n      //it came from the navbar login, then we should send the user to profile page first\n    } else {\n      alert('Login failed');\n      // throw new Error();\n    }\n  };\n\n  return (\n    <form\n      className=\"sign-in\"\n      onSubmit={handleSubmit}\n      // style={{\n      //   display: 'flex',\n      //   flexDirection: 'column',\n      //   width: '30vw',\n      //   margin: '0 auto',\n      //   marginTop: '8vw',\n      //   justifyContent: 'space-around',\n      //   height: '35vw',\n      //   border: '1px solid grey',\n      //   borderRadius: '1rem',\n      //   padding: '3rem',\n      // }}\n    >\n      <div className=\"field\" style={{ width: '100%' }}>\n        <label>\n          email\n          <input\n            name=\"email\"\n            type=\"email\"\n            value={state.email}\n            onChange={handleChange}\n            required\n            style={{\n              width: '100%',\n              letterSpacing: '.2rem',\n              height: '2rem',\n              border: 'none',\n              borderBottom: '1px solid grey',\n            }}\n          />\n        </label>\n      </div>\n      <div className=\"field\">\n        <label>password</label>\n        <input\n          name=\"password\"\n          type=\"password\"\n          value={state.password}\n          onChange={handleChange}\n          required\n          style={{\n            width: '100%',\n            letterSpacing: '.3rem',\n            height: '2rem',\n            border: 'none',\n            borderBottom: '1px solid grey',\n          }}\n        />\n      </div>\n      {/* <button disabled={!buttonEnabled}>Sign in</button> */}\n      <button>Log in</button>\n    </form>\n  );\n};\n\nexport default withRouter(Login);\n"]},"metadata":{},"sourceType":"module"}